<?php
session_start();

$correct_password = 'sohayb';
$storage_file = 'hidden_data.txt';

// Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©
if (isset($_POST['message']) && trim($_POST['message']) !== '') {
    $msg = strip_tags($_POST['message']);
    file_put_contents($storage_file, $msg . PHP_EOL, FILE_APPEND);
    $status = "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.";
}

// Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø®Ø²Ù†Ø©
if (isset($_POST['vault_password'])) {
    if ($_POST['vault_password'] === $correct_password) {
        $_SESSION['vault_access'] = true;
    } else {
        $error = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.";
    }
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©
if (isset($_GET['logout'])) {
    session_destroy();
    header("Location: " . strtok($_SERVER["REQUEST_URI"], '?'));
    exit;
}
?>

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¢Ù…Ù†</title>
<style>
  body { font-family: Arial, sans-serif; direction: rtl; padding: 30px; }
  .container { max-width: 600px; margin: auto; border: 1px solid #ddd; padding: 20px; border-radius: 10px; }
  textarea { width: 100%; height: 80px; margin-bottom: 10px; }
  .vault-form { float: left; }
  .status { color: green; }
  .error { color: red; }
  pre { background: #eee; padding: 10px; max-height: 300px; overflow: auto; }
</style>
</head>
<body>

<div class="container">
  <h2>ğŸ“© Ø£Ø±Ø³Ù„ Ù„ÙŠ Ø±Ø³Ø§Ù„Ø©</h2>
  
  <?php if (isset($status)) echo "<p class='status'>$status</p>"; ?>

  <form method="post">
    <textarea name="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." required></textarea><br>
    <button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
  </form>

  <hr>

  <div style="overflow: hidden;">
    <form method="post" class="vault-form">
      <input type="password" name="vault_password" placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„Ù„Ø®Ø²Ù†Ø©" required>
      <button type="submit">Ø¯Ø®ÙˆÙ„</button>
    </form>
  </div>

  <?php if (isset($error)) echo "<p class='error'>$error</p>"; ?>

  <?php if (isset($_SESSION['vault_access']) && $_SESSION['vault_access']): ?>
    <h3>ğŸ—„ï¸ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø²Ù†Ø©</h3>
    <pre>
<?php
if (file_exists($storage_file)) {
    echo htmlspecialchars(file_get_contents($storage_file));
} else {
    echo "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ù…Ø®Ø²Ù†Ø©.";
}
?>
    </pre>
    <a href="?logout=1">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©</a>
  <?php endif; ?>

</div>

</body>
</html>
